<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>豪華カツ丼が作れる！～ことわざクイズ～</title>
    <!-- Tailwind CSS読み込み -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* カスタムフォント設定 */
        :root {
            font-family: 'Inter', sans-serif;
        }
        /* キッチンカウンター風の背景 */
        body {
            background-color: #f8f6f0; /* 薄いクリーム色の壁 */
        }
        .kitchen-floor {
            /* 木目調のカウンター風デザイン */
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 20vh;
            background-color: #964b00; /* 茶色 */
            background-image: linear-gradient(90deg, rgba(255,255,255,.1) 1px, transparent 1px), 
                             linear-gradient(180deg, rgba(255,255,255,.1) 1px, transparent 1px);
            background-size: 50px 50px;
            z-index: 0;
            box-shadow: inset 0 8px 16px rgba(0, 0, 0, 0.1);
        }
        #app {
            z-index: 10;
        }
        /* 材料アイコンの豪華アニメーション */
        .material-upgraded {
            animation: bounce-in 0.5s ease-out;
            color: #d97706; /* Tailwind: amber-600 */
        }
        @keyframes bounce-in {
            0% { transform: scale(0.5); opacity: 0; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); }
        }
        /* ルビのスタイル調整 (読みやすくするため) */
        ruby rt {
            font-size: 0.5em; /* 親文字に対して小さいサイズ */
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <!-- キッチンカウンター背景 -->
    <div class="kitchen-floor"></div>

    <div id="app" class="w-full max-w-lg bg-white shadow-2xl rounded-xl p-6 md:p-10 border-t-8 border-yellow-600">
        
        <!-- タイトルを二行表示に修正し、ルビを適用 -->
        <h1 class="text-3xl font-extrabold text-gray-900 mb-6 text-center leading-tight">
            <span class="block">豪華<ruby>カツ<rt>かつ</rt></ruby><ruby>丼<rt>どん</rt></ruby>が作れる！</span>
            <span class="block text-xl md:text-2xl text-yellow-700">～ことわざクイズ～</span>
        </h1>
        
        <!-- 進捗とスコア表示 -->
        <div id="status-bar" class="text-center mb-4 text-sm font-medium text-gray-600">
            <span id="score-display">スコア: 0 / 10</span> | 
            <span id="progress-display">問題 1 / 10</span>
        </div>

        <!-- 材料ゲット進捗バー (10種類) -->
        <div id="material-progress" class="grid grid-cols-5 gap-3 justify-items-center mb-6 p-4 bg-yellow-50 rounded-xl shadow-inner border border-yellow-300">
            
            <!-- 10種類の材料スロット -->
            <div id="mat-katsu" class="material-slot text-center text-gray-400 transition duration-300">
                <span class="text-3xl"></span><p class="text-xs font-semibold">豚肉</p>
            </div>
            <div id="mat-egg" class="material-slot text-center text-gray-400 transition duration-300">
                <span class="text-3xl"></span><p class="text-xs font-semibold">卵</p>
            </div>
            <div id="mat-rice" class="material-slot text-center text-gray-400 transition duration-300">
                <span class="text-3xl"></span><p class="text-xs font-semibold">ご飯</p>
            </div>
            <div id="mat-onion" class="material-slot text-center text-gray-400 transition duration-300">
                <span class="text-3xl"></span><p class="text-xs font-semibold">玉ねぎ</p>
            </div>
            <div id="mat-mitsuba" class="material-slot text-center text-gray-400 transition duration-300">
                <span class="text-3xl"></span><p class="text-xs font-semibold">三つ葉</p>
            </div>
            <div id="mat-panko" class="material-slot text-center text-gray-400 transition duration-300">
                <span class="text-3xl"></span><p class="text-xs font-semibold">パン粉</p>
            </div>
            <div id="mat-oil" class="material-slot text-center text-gray-400 transition duration-300">
                <span class="text-3xl"></span><p class="text-xs font-semibold">油</p>
            </div>
            <div id="mat-soy" class="material-slot text-center text-gray-400 transition duration-300">
                <span class="text-3xl"></span><p class="text-xs font-semibold">醤油</p>
            </div>
            <div id="mat-sugar" class="material-slot text-center text-gray-400 transition duration-300">
                <span class="text-3xl"></span><p class="text-xs font-semibold">砂糖</p>
            </div>
            <div id="mat-bowl" class="material-slot text-center text-gray-400 transition duration-300">
                <span class="text-3xl"></span><p class="text-xs font-semibold">器</p>
            </div>
        </div>

        <div id="quiz-area">
            <div id="question-container" class="mb-8">
                <!-- 問題文にルビを適用するため、テキストではなくinnerHTMLを使用 -->
                <p id="question-text" class="text-lg md:text-xl font-semibold text-gray-700 mb-4 bg-yellow-100 p-4 rounded-lg shadow-inner">
                    <!-- 問題文がここに挿入されます -->
                </p>
                <div id="answer-options" class="space-y-3">
                    <!-- 選択肢ボタン -->
                    <button data-answer="1" class="answer-btn w-full text-left py-3 px-5 bg-white text-gray-800 border-2 border-yellow-300 rounded-lg hover:bg-yellow-100 transition duration-150 font-medium shadow-md">
                        <!-- 選択肢 1 -->
                    </button>
                    <button data-answer="2" class="answer-btn w-full text-left py-3 px-5 bg-white text-gray-800 border-2 border-yellow-300 rounded-lg hover:bg-yellow-100 transition duration-150 font-medium shadow-md">
                        <!-- 選択肢 2 -->
                    </button>
                    <button data-answer="3" class="answer-btn w-full text-left py-3 px-5 bg-white text-gray-800 border-2 border-yellow-300 rounded-lg hover:bg-yellow-100 transition duration-150 font-medium shadow-md">
                        <!-- 選択肢 3 -->
                    </button>
                </div>
            </div>

            <!-- 結果メッセージエリア（各問題の判定用） -->
            <div id="result-message" class="text-center p-4 rounded-lg mb-4 hidden transition duration-300 ease-in-out">
                <!-- 正誤判定メッセージがここに表示されます -->
            </div>
            
            <!-- 回答後の解説エリア -->
            <div id="explanation-area" class="p-4 bg-gray-100 rounded-lg text-sm text-gray-700 mb-6 hidden">
                <p class="font-bold text-gray-900 mb-1">【ことわざ解説】</p>
                <!-- 解説文にルビを適用するため、テキストではなくinnerHTMLを使用 -->
                <p id="explanation-text"></p>
            </div>

            <!-- 次の問題へ/結果表示ボタン -->
            <button id="next-button" class="w-full py-3 bg-yellow-600 text-white font-bold rounded-lg shadow-lg hover:bg-yellow-700 transition duration-150 disabled:bg-yellow-400">
                次の問題へ
            </button>
        </div>
        
        <!-- 最終結果表示エリア (初期状態は非表示) -->
        <div id="final-result-area" class="hidden text-center">
            <h2 id="final-message" class="text-2xl font-extrabold mb-4"></h2>
            <p id="grade-explanation" class="text-gray-700 mb-6"></p>
            
            <!-- 完成したカツ丼の画像コンテナ -->
            <div id="katsudon-image-container" class="w-full h-auto rounded-lg shadow-xl mb-6 aspect-video border-4 border-yellow-500 flex items-center justify-center bg-gray-200 text-gray-600 font-semibold text-lg">
                 <span id="initial-message">結果を待っています...</span>
            </div>
            
            <button id="restart-button" class="w-full py-3 bg-indigo-600 text-white font-bold rounded-lg shadow-lg hover:bg-indigo-700 transition duration-150" onclick="setupQuiz()">
                もう一度挑戦して豪華カツ丼を目指す
            </button>
        </div>
        
        <div class="mt-4 text-xs text-gray-500 text-center">
            (全10問出題。<ruby>正解<rt>せいかい</rt></ruby><ruby>数<rt>すう</rt></ruby>に<ruby>応<rt>おう</rt></ruby>じて10<ruby>種類<rt>しゅるい</rt></ruby>の<ruby>材料<rt>ざいりょう</rt></ruby>がアップグレードされます。)
        </div>

    </div>

    <script>
        // 全問題データ: 20問 (解説付き) - ルビを適用
        const allQuizData = [
            { q: "「<ruby>猿<rt>さる</rt></ruby>も<ruby>木<rt>き</rt></ruby>から<ruby>落<rt>お</rt></ruby>ちる」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "どんな<ruby>名<rt>めい</rt></ruby><ruby>人<rt>じん</rt></ruby>でも<ruby>失<rt>しっ</rt></ruby><ruby>敗<rt>ぱい</rt></ruby>することがある。", distractors: ["<ruby>猿<rt>さる</rt></ruby>は<ruby>木<rt>き</rt></ruby>から<ruby>落<rt>お</rt></ruby>ちると<ruby>大<rt>おお</rt></ruby><ruby>怪我<rt>けが</rt></ruby>をする。", "<ruby>猿<rt>さる</rt></ruby>は<ruby>木<rt>き</rt></ruby>の<ruby>上<rt>うえ</rt></ruby>で<ruby>生活<rt>せいかつ</rt></ruby>するのが<ruby>苦<rt>にが</rt></ruby>てだ。"], commentary: "<ruby>木<rt>き</rt></ruby>のぼりが<ruby>得<rt>とく</rt></ruby><ruby>意<rt>い</rt></ruby>な<ruby>猿<rt>さる</rt></ruby>でも<ruby>失<rt>しっ</rt></ruby><ruby>敗<rt>ぱい</rt></ruby>するように、どんなに<ruby>優<rt>すぐ</rt></ruby>れた<ruby>人<rt>ひと</rt></ruby>でも<ruby>間<rt>ま</rt></ruby>ち<ruby>が<rt>が</rt></ruby>いを<ruby>犯<rt>おか</rt></ruby>すことがある、という<ruby>意味<rt>いみ</rt></ruby>です。" },
            { q: "「<ruby>一<rt>いっ</rt></ruby><ruby>石<rt>せき</rt></ruby><ruby>二<rt>に</rt></ruby><ruby>鳥<rt>ちょう</rt></ruby>」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "一つの<ruby>行<rt>こう</rt></ruby><ruby>為<rt>い</rt></ruby>で<ruby>二<rt>ふた</rt></ruby>つの<ruby>利<rt>り</rt></ruby><ruby>益<rt>えき</rt></ruby>を<ruby>得<rt>え</rt></ruby>ること。", distractors: ["<ruby>石<rt>いし</rt></ruby>を<ruby>投<rt>な</rt></ruby>げればすぐに<ruby>鳥<rt>とり</rt></ruby>が<ruby>落<rt>お</rt></ruby>ちてくる。", "<ruby>二<rt>ふた</rt></ruby>つの<ruby>石<rt>いし</rt></ruby>を<ruby>同<rt>どう</rt></ruby><ruby>時<rt>じ</rt></ruby>に<ruby>投<rt>な</rt></ruby>げること。"], commentary: "一つの<ruby>石<rt>いし</rt></ruby>で<ruby>二<rt>に</rt></ruby><ruby>羽<rt>わ</rt></ruby>の<ruby>鳥<rt>とり</rt></ruby>を<ruby>捕<rt>つか</rt></ruby>まえるように、<ruby>一<rt>いち</rt></ruby><ruby>度<rt>ど</rt></ruby>の<ruby>行<rt>こう</rt></ruby><ruby>動<rt>どう</rt></ruby>で<ruby>二<rt>ふた</rt></ruby>つの<ruby>成<rt>せい</rt></ruby><ruby>果<rt>か</rt></ruby>を<ruby>得<rt>え</rt></ruby>ることを<ruby>指<rt>さ</rt></ruby>します。" },
            { q: "「<ruby>弘法<rt>こうぼう</rt></ruby>にも<ruby>筆<rt>ふで</rt></ruby>の<ruby>誤<rt>あやま</rt></ruby>り」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>名<rt>めい</rt></ruby><ruby>人<rt>じん</rt></ruby>でも<ruby>時<rt>とき</rt></ruby>には<ruby>失<rt>しっ</rt></ruby><ruby>敗<rt>ぱい</rt></ruby>するということ。", distractors: ["<ruby>弘法<rt>こうぼう</rt></ruby><ruby>大<rt>だい</rt></ruby><ruby>師<rt>し</rt></ruby>は<ruby>筆<rt>ふで</rt></ruby>を<ruby>間<rt>ま</rt></ruby>ち<ruby>が<rt>が</rt></ruby>えることはなかった。", "<ruby>筆<rt>ふで</rt></ruby>を<ruby>使<rt>つか</rt></ruby>って<ruby>書<rt>か</rt></ruby>くのは<ruby>難<rt>むずか</rt></ruby>しいということ。"], commentary: "<ruby>書<rt>しょ</rt></ruby><ruby>道<rt>どう</rt></ruby>の<ruby>達<rt>たっ</rt></ruby><ruby>人<rt>じん</rt></ruby>である<ruby>弘法<rt>こうぼう</rt></ruby><ruby>大<rt>だい</rt></ruby><ruby>師<rt>し</rt></ruby>でも<ruby>書<rt>か</rt></ruby>き<ruby>間<rt>ま</rt></ruby>ち<ruby>が<rt>が</rt></ruby>えることがある、という<ruby>例<rt>たと</rt></ruby>えで、<ruby>誰<rt>だれ</rt></ruby>でも<ruby>失<rt>しっ</rt></ruby><ruby>敗<rt>ぱい</rt></ruby>する<ruby>可能<rt>かのう</rt></ruby><ruby>性<rt>せい</rt></ruby>を<ruby>示<rt>しめ</rt></ruby>しています。" },
            { q: "「<ruby>二<rt>に</rt></ruby><ruby>兎<rt>と</rt></ruby>を<ruby>追<rt>お</rt></ruby>う<ruby>者<rt>もの</rt></ruby>は<ruby>一<rt>いっ</rt></ruby><ruby>兎<rt>と</rt></ruby>をも<ruby>得<rt>え</rt></ruby>ず」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>欲<rt>よく</rt></ruby>ばって<ruby>二<rt>ふた</rt></ruby>つのものを<ruby>同<rt>どう</rt></ruby><ruby>時<rt>じ</rt></ruby>に<ruby>得<rt>え</rt></ruby>ようとすると、<ruby>結<rt>けっ</rt></ruby><ruby>局<rt>きょく</rt></ruby>は<ruby>両<rt>りょう</rt></ruby><ruby>方<rt>ほう</rt></ruby>とも<ruby>手<rt>て</rt></ruby>に<ruby>入<rt>はい</rt></ruby>らない。", distractors: ["<ruby>二<rt>に</rt></ruby><ruby>匹<rt>ひき</rt></ruby>のウサギを<ruby>追<rt>お</rt></ruby>いかけるのは<ruby>楽<rt>たの</rt></ruby>しい。", "ウサギを<ruby>追<rt>お</rt></ruby>いかけるときは<ruby>必<rt>かなら</rt></ruby>ず<ruby>二<rt>に</rt></ruby><ruby>羽<rt>わ</rt></ruby>にするべきだ。"], commentary: "<ruby>二<rt>ふた</rt></ruby>つの<ruby>目<rt>もく</rt></ruby><ruby>標<rt>ひょう</rt></ruby>を<ruby>同<rt>どう</rt></ruby><ruby>時<rt>じ</rt></ruby>に<ruby>追<rt>お</rt></ruby>うと、どちらにも<ruby>集<rt>しゅう</rt></ruby><ruby>中<rt>ちゅう</rt></ruby>できず<ruby>失<rt>しっ</rt></ruby><ruby>敗<rt>ぱい</rt></ruby>に<ruby>終<rt>お</rt></ruby>わる、という<ruby>戒<rt>いまし</rt></ruby>めの<ruby>言<rt>こと</rt></ruby><ruby>葉<rt>ば</rt></ruby>です。" },
            { q: "「<ruby>石<rt>いし</rt></ruby>の<ruby>上<rt>うえ</rt></ruby>にも<ruby>三<rt>さん</rt></ruby><ruby>年<rt>ねん</rt></ruby>」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>辛<rt>つら</rt></ruby>いことでも<ruby>我<rt>が</rt></ruby><ruby>慢<rt>まん</rt></ruby>し<ruby>続<rt>つづ</rt></ruby>ければ、<ruby>必<rt>かなら</rt></ruby>ず<ruby>成<rt>せい</rt></ruby><ruby>功<rt>こう</rt></ruby>する。", distractors: ["<ruby>石<rt>いし</rt></ruby>の<ruby>上<rt>うえ</rt></ruby>で<ruby>三<rt>さん</rt></ruby><ruby>年<rt>ねん</rt></ruby><ruby>生活<rt>せいかつ</rt></ruby>するのは<ruby>健<rt>けん</rt></ruby><ruby>康<rt>こう</rt></ruby>に<ruby>良<rt>よ</rt></ruby>い。", "<ruby>石<rt>いし</rt></ruby>は<ruby>三<rt>さん</rt></ruby><ruby>年<rt>ねん</rt></ruby><ruby>経<rt>た</rt></ruby>つと<ruby>温<rt>あたた</rt></ruby>かくなる。"], commentary: "<ruby>冷<rt>つめ</rt></ruby>たい<ruby>石<rt>いし</rt></ruby>の<ruby>上<rt>うえ</rt></ruby>でも<ruby>三<rt>さん</rt></ruby><ruby>年<rt>ねん</rt></ruby><ruby>座<rt>すわ</rt></ruby>り<ruby>続<rt>つづ</rt></ruby>ければ<ruby>温<rt>あたた</rt></ruby>まるように、<ruby>忍<rt>にん</rt></ruby><ruby>耐<rt>たい</rt></ruby>く<ruby>続<rt>つづ</rt></ruby>ければ<ruby>報<rt>むく</rt></ruby>われる、という<ruby>意味<rt>いみ</rt></ruby>です。" },
            { q: "「<ruby>塵<rt>ちり</rt></ruby>も<ruby>積<rt>つも</rt></ruby>もれば<ruby>山<rt>やま</rt></ruby>となる」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>小<rt>ちい</rt></ruby>さなものでも、たくさん<ruby>集<rt>あつ</rt></ruby>まれば<ruby>大<rt>おお</rt></ruby>きなものになる。", distractors: ["<ruby>塵<rt>ちり</rt></ruby>を<ruby>集<rt>あつ</rt></ruby>めて<ruby>山<rt>やま</rt></ruby>を<ruby>作<rt>つく</rt></ruby>るのは<ruby>不<rt>ふ</rt></ruby><ruby>可<rt>か</rt></ruby><ruby>能<rt>のう</rt></ruby>だ。", "<ruby>山<rt>やま</rt></ruby>は<ruby>塵<rt>ちり</rt></ruby>でできている。"], commentary: "<ruby>小<rt>ちい</rt></ruby>さな<ruby>塵<rt>ちり</rt></ruby>でも<ruby>積<rt>つ</rt></ruby>み<ruby>重<rt>かさ</rt></ruby>なれば<ruby>山<rt>やま</rt></ruby>になるように、わずかな<ruby>努<rt>ど</rt></ruby><ruby>力<rt>りょく</rt></ruby>でも<ruby>継<rt>けい</rt></ruby><ruby>続<rt>ぞく</rt></ruby>すれば<ruby>大<rt>おお</rt></ruby>きな<ruby>成<rt>せい</rt></ruby><ruby>果<rt>か</rt></ruby>につながることを<ruby>示<rt>しめ</rt></ruby>します。" },
            { q: "「<ruby>三<rt>さん</rt></ruby><ruby>人<rt>にん</rt></ruby><ruby>寄<rt>よ</rt></ruby>れば<ruby>文殊<rt>もんじゅ</rt></ruby>の<ruby>知<rt>ち</rt></ruby><ruby>恵<rt>え</rt></ruby>」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>平<rt>へい</rt></ruby><ruby>凡<rt>ぼん</rt></ruby>な<ruby>人<rt>にん</rt></ruby><ruby>間<rt>げん</rt></ruby>でも<ruby>三<rt>さん</rt></ruby><ruby>人<rt>にん</rt></ruby><ruby>集<rt>あつ</rt></ruby>まって<ruby>相<rt>そう</rt></ruby><ruby>談<rt>だん</rt></ruby>すれば、<ruby>良<rt>よ</rt></ruby>い<ruby>知<rt>ち</rt></ruby><ruby>恵<rt>え</rt></ruby>が<ruby>出<rt>で</rt></ruby>るものだ。", distractors: ["<ruby>文殊<rt>もんじゅ</rt></ruby><ruby>菩<rt>ぼ</rt></ruby><ruby>薩<rt>さつ</rt></ruby>は<ruby>三<rt>みっ</rt></ruby>つの<ruby>知<rt>ち</rt></ruby><ruby>恵<rt>え</rt></ruby>を<ruby>持<rt>も</rt></ruby>っている。", "<ruby>三<rt>さん</rt></ruby><ruby>人<rt>にん</rt></ruby>で<ruby>文<rt>ぶん</rt></ruby><ruby>集<rt>しゅう</rt></ruby>を<ruby>作<rt>つく</rt></ruby>ると<ruby>良<rt>よ</rt></ruby>いものができる。"], commentary: "<ruby>知<rt>ち</rt></ruby><ruby>恵<rt>え</rt></ruby>の<ruby>象<rt>しょう</rt></ruby><ruby>徴<rt>ちょう</rt></ruby>である<ruby>文殊<rt>もんじゅ</rt></ruby><ruby>菩<rt>ぼ</rt></ruby><ruby>薩<rt>さつ</rt></ruby>に<ruby>例<rt>たと</rt></ruby>えて、<ruby>多<rt>た</rt></ruby><ruby>数<rt>すう</rt></ruby>で<ruby>議<rt>ぎ</rt></ruby><ruby>論<rt>ろん</rt></ruby>すれば<ruby>優<rt>すぐ</rt></ruby>れたアイデアが<ruby>生<rt>う</rt></ruby>まれる、という<ruby>意味<rt>いみ</rt></ruby>です。" },
            { q: "「<ruby>急<rt>いそ</rt></ruby>がば<ruby>回<rt>まわ</rt></ruby>れ」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>危<rt>き</rt></ruby><ruby>険<rt>けん</rt></ruby>な<ruby>近<rt>ちか</rt></ruby><ruby>道<rt>みち</rt></ruby>よりも、<ruby>遠<rt>とお</rt></ruby><ruby>回<rt>まわ</rt></ruby>りでも<ruby>安<rt>あん</rt></ruby><ruby>全<rt>ぜん</rt></ruby>で<ruby>確<rt>かく</rt></ruby><ruby>実<rt>じつ</rt></ruby>な<ruby>方<rt>ほう</rt></ruby><ruby>法<rt>ほう</rt></ruby>をとる<ruby>方<rt>ほう</rt></ruby>が<ruby>早<rt>はや</rt></ruby>く<ruby>目<rt>もく</rt></ruby><ruby>的<rt>てき</rt></ruby>を<ruby>達<rt>たっ</rt></ruby><ruby>成<rt>せい</rt></ruby>できる。", distractors: ["<ruby>急<rt>いそ</rt></ruby>いでいるときこそ<ruby>回<rt>まわ</rt></ruby>るべきだ。", "<ruby>急<rt>いそ</rt></ruby>いでいるときは<ruby>一<rt>ひと</rt></ruby><ruby>旦<rt>たん</rt></ruby><ruby>立<rt>た</rt></ruby>ち<ruby>止<rt>ど</rt></ruby>まるべきだ。"], commentary: "<ruby>急<rt>いそ</rt></ruby>いでいる<ruby>時<rt>とき</rt></ruby>こそ、<ruby>焦<rt>あせ</rt></ruby>らず<ruby>確<rt>かく</rt></ruby><ruby>実<rt>じつ</rt></ruby>な<ruby>道<rt>みち</rt></ruby>を<ruby>選<rt>えら</rt></ruby>ぶべきだという<ruby>教<rt>きょう</rt></ruby><ruby>訓<rt>くん</rt></ruby>です。" },
            { q: "「<ruby>河<rt>か</rt></ruby><ruby>童<rt>っぱ</rt></ruby>の<ruby>川<rt>かわ</rt></ruby><ruby>流<rt>なが</rt></ruby>れ」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>泳<rt>およ</rt></ruby>ぎの<ruby>得<rt>とく</rt></ruby><ruby>意<rt>い</rt></ruby>な<ruby>河<rt>か</rt></ruby><ruby>童<rt>っぱ</rt></ruby>でも、<ruby>時<rt>とき</rt></ruby>には<ruby>川<rt>かわ</rt></ruby>で<ruby>流<rt>なが</rt></ruby>されることがある。<ruby>得<rt>とく</rt></ruby><ruby>意<rt>い</rt></ruby>な<ruby>人<rt>ひと</rt></ruby>でも<ruby>失<rt>しっ</rt></ruby><ruby>敗<rt>ぱい</rt></ruby>することがあるということ。", distractors: ["<ruby>河<rt>か</rt></ruby><ruby>童<rt>っぱ</rt></ruby>は<ruby>川<rt>かわ</rt></ruby>の<ruby>流<rt>なが</rt></ruby>れに<ruby>逆<rt>さか</rt></ruby>らって<ruby>泳<rt>およ</rt></ruby>ぐのが<ruby>好<rt>す</rt></ruby>きだ。", "<ruby>河<rt>か</rt></ruby><ruby>童<rt>っぱ</rt></ruby>が<ruby>川<rt>かわ</rt></ruby>で<ruby>流<rt>なが</rt></ruby>されるのは<ruby>珍<rt>めずら</rt></ruby>しいことではない。"], commentary: "<ruby>得<rt>とく</rt></ruby><ruby>意<rt>い</rt></ruby>な<ruby>分<rt>ぶん</rt></ruby><ruby>野<rt>や</rt></ruby>で<ruby>油<rt>ゆ</rt></ruby><ruby>断<rt>だん</rt></ruby>して<ruby>失<rt>しっ</rt></ruby><ruby>敗<rt>ぱい</rt></ruby>することの<ruby>例<rt>たと</rt></ruby>えです。" },
            { q: "「<ruby>猫<rt>ねこ</rt></ruby>に<ruby>小<rt>こ</rt></ruby><ruby>判<rt>ばん</rt></ruby>」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>価<rt>か</rt></ruby><ruby>値<rt>ち</rt></ruby>の<ruby>分<rt>わ</rt></ruby>からないものに<ruby>貴<rt>き</rt></ruby><ruby>重<rt>ちょう</rt></ruby>なものを<ruby>与<rt>あた</rt></ruby>えても<ruby>無<rt>む</rt></ruby><ruby>駄<rt>だ</rt></ruby>になること。", distractors: ["<ruby>猫<rt>ねこ</rt></ruby>は<ruby>小<rt>こ</rt></ruby><ruby>判<rt>ばん</rt></ruby>が<ruby>好<rt>す</rt></ruby>きだ。", "<ruby>猫<rt>ねこ</rt></ruby>は<ruby>小<rt>こ</rt></ruby><ruby>判<rt>ばん</rt></ruby>で<ruby>買<rt>か</rt></ruby>い<ruby>物<rt>もの</rt></ruby>をしようとする。"], commentary: "<ruby>猫<rt>ねこ</rt></ruby>に<ruby>高<rt>こう</rt></ruby><ruby>価<rt>か</rt></ruby>な<ruby>小<rt>こ</rt></ruby><ruby>判<rt>ばん</rt></ruby>を<ruby>与<rt>あた</rt></ruby>えても<ruby>使<rt>つか</rt></ruby>い<ruby>道<rt>みち</rt></ruby>がないように、<ruby>理<rt>り</rt></ruby><ruby>解<rt>かい</rt></ruby>できない<ruby>人<rt>ひと</rt></ruby>に<ruby>貴<rt>き</rt></ruby><ruby>重<rt>ちょう</rt></ruby>なものを<ruby>与<rt>あた</rt></ruby>えるのは<ruby>無<rt>む</rt></ruby><ruby>意<rt>い</rt></ruby><ruby>味<rt>み</rt></ruby>だ、という<ruby>意味<rt>いみ</rt></ruby>です。" },
            { q: "「<ruby>灯<rt>とう</rt></ruby><ruby>台<rt>だい</rt></ruby><ruby>下<rt>もと</rt></ruby><ruby>暗<rt>くら</rt></ruby>し」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>身<rt>み</rt></ruby><ruby>近<rt>ぢか</rt></ruby>なことはかえって<ruby>気<rt>き</rt></ruby>がつかないこと。", distractors: ["<ruby>灯<rt>とう</rt></ruby><ruby>台<rt>だい</rt></ruby>の<ruby>光<rt>ひかり</rt></ruby>は<ruby>下<rt>した</rt></ruby>を<ruby>照<rt>て</rt></ruby>らさない。", "<ruby>灯<rt>とう</rt></ruby><ruby>台<rt>だい</rt></ruby>の<ruby>下<rt>した</rt></ruby>は<ruby>非<rt>ひ</rt></ruby><ruby>常<rt>じょう</rt></ruby>に<ruby>暗<rt>くら</rt></ruby>い。"], commentary: "<ruby>灯<rt>とう</rt></ruby><ruby>台<rt>だい</rt></ruby>の<ruby>真<rt>ま</rt></ruby><ruby>下<rt>した</rt></ruby>は<ruby>光<rt>ひかり</rt></ruby>が<ruby>当<rt>あ</rt></ruby>たらず<ruby>暗<rt>くら</rt></ruby>いように、<ruby>身<rt>み</rt></ruby>の<ruby>回<rt>まわ</rt></ruby>りのことほど<ruby>案<rt>あん</rt></ruby><ruby>外<rt>がい</rt></ruby><ruby>気<rt>き</rt></ruby>づきにくい、という<ruby>意味<rt>いみ</rt></ruby>です。" },
            { q: "「<ruby>泣<rt>な</rt></ruby>きっ<ruby>面<rt>つら</rt></ruby>に<ruby>蜂<rt>はち</rt></ruby>」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>悪<rt>わる</rt></ruby>いことの<ruby>上<rt>うえ</rt></ruby>にも、さらに<ruby>悪<rt>わる</rt></ruby>いことが<ruby>重<rt>かさ</rt></ruby>なること。", distractors: ["<ruby>泣<rt>な</rt></ruby>いている<ruby>人<rt>ひと</rt></ruby>の<ruby>顔<rt>かお</rt></ruby>に<ruby>蜂<rt>はち</rt></ruby>が<ruby>止<rt>と</rt></ruby>まるのは<ruby>珍<rt>めずら</rt></ruby>しい。", "<ruby>蜂<rt>はち</rt></ruby>に<ruby>刺<rt>さ</rt></ruby>されたら<ruby>泣<rt>な</rt></ruby>くしかない。"], commentary: "<ruby>不<rt>ふ</rt></ruby><ruby>幸<rt>こう</rt></ruby>が<ruby>重<rt>かさ</rt></ruby>なることの<ruby>例<rt>たと</rt></ruby>えです。" },
            { q: "「<ruby>犬<rt>いぬ</rt></ruby>も<ruby>歩<rt>ある</rt></ruby>けば<ruby>棒<rt>ぼう</rt></ruby>に<ruby>当<rt>あ</rt></ruby>たる」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>行<rt>こう</rt></ruby><ruby>動<rt>どう</rt></ruby>を<ruby>起<rt>お</rt></ruby>こせば<ruby>予<rt>よ</rt></ruby><ruby>期<rt>き</rt></ruby>せぬ<ruby>幸<rt>こう</rt></ruby><ruby>運<rt>うん</rt></ruby>に<ruby>出<rt>で</rt></ruby><ruby>会<rt>あ</rt></ruby>うこともあるし、<ruby>災<rt>さい</rt></ruby><ruby>難<rt>なん</rt></ruby>に<ruby>遭<rt>あ</rt></ruby>うこともある。", distractors: ["<ruby>犬<rt>いぬ</rt></ruby>が<ruby>棒<rt>ぼう</rt></ruby>を<ruby>持<rt>も</rt></ruby>って<ruby>歩<rt>ある</rt></ruby>くのは<ruby>危<rt>き</rt></ruby><ruby>険<rt>けん</rt></ruby>だ。", "<ruby>犬<rt>いぬ</rt></ruby>は<ruby>歩<rt>ある</rt></ruby>いていると<ruby>必<rt>かなら</rt></ruby>ず<ruby>棒<rt>ぼう</rt></ruby>に<ruby>当<rt>あ</rt></ruby>たる。"], commentary: "何か<ruby>行<rt>こう</rt></ruby><ruby>動<rt>どう</rt></ruby>を<ruby>起<rt>お</rt></ruby>こせば、<ruby>良<rt>よ</rt></ruby>いことにも<ruby>悪<rt>わる</rt></ruby>いことにも<ruby>遭<rt>そう</rt></ruby><ruby>遇<rt>ぐう</rt></ruby>する<ruby>可能<rt>かのう</rt></ruby><ruby>性<rt>せい</rt></ruby>がある、という<ruby>意味<rt>いみ</rt></ruby>です。" },
            { q: "「<ruby>知<rt>し</rt></ruby>らぬが<ruby>仏<rt>ほとけ</rt></ruby>」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>知<rt>し</rt></ruby>らなければ<ruby>心<rt>こころ</rt></ruby><ruby>穏<rt>おだ</rt></ruby>やかでいられること。", distractors: ["<ruby>仏<rt>ほとけ</rt></ruby><ruby>様<rt>さま</rt></ruby>は<ruby>知<rt>し</rt></ruby>らないことが多い。", "<ruby>知<rt>し</rt></ruby>らないことは<ruby>仏<rt>ほとけ</rt></ruby><ruby>様<rt>さま</rt></ruby>のように<ruby>崇<rt>あが</rt></ruby>められる。"], commentary: "<ruby>知<rt>し</rt></ruby>らないことで<ruby>心<rt>こころ</rt></ruby>が<ruby>乱<rt>みだ</rt></ruby>れずに<ruby>済<rt>す</rt></ruby>む、という<ruby>意味<rt>いみ</rt></ruby>です。" },
            { q: "「<ruby>花<rt>はな</rt></ruby>より<ruby>団<rt>だん</rt></ruby><ruby>子<rt>ご</rt></ruby>」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>見<rt>み</rt></ruby>た<ruby>目<rt>め</rt></ruby>や<ruby>風<rt>ふう</rt></ruby><ruby>流<rt>りゅう</rt></ruby>よりも<ruby>実<rt>じつ</rt></ruby><ruby>益<rt>えき</rt></ruby>を<ruby>選<rt>えら</rt></ruby>ぶこと。", distractors: ["<ruby>団<rt>だん</rt></ruby><ruby>子<rt>ご</rt></ruby>は<ruby>花<rt>はな</rt></ruby>よりも<ruby>美<rt>おい</rt></ruby>しい。", "<ruby>花<rt>はな</rt></ruby><ruby>見<rt>み</rt></ruby>には<ruby>団<rt>だん</rt></ruby><ruby>子<rt>ご</rt></ruby>が<ruby>欠<rt>か</rt></ruby>かせない。"], commentary: "<ruby>美<rt>うつく</rt></ruby>しい<ruby>花<rt>はな</rt></ruby>を<ruby>観<rt>かん</rt></ruby><ruby>賞<rt>しょう</rt></ruby>するよりも、<ruby>腹<rt>はら</rt></ruby>を<ruby>満<rt>み</rt></ruby>たす<ruby>団<rt>だん</rt></ruby><ruby>子<rt>ご</rt></ruby>を<ruby>選<rt>えら</rt></ruby>ぶように、<ruby>実<rt>じつ</rt></ruby><ruby>用<rt>よう</rt></ruby><ruby>的<rt>てき</rt></ruby>なものを<ruby>好<rt>この</rt></ruby>むことの<ruby>例<rt>たと</rt></ruby>えです。" },
            { q: "「<ruby>負<rt>ま</rt></ruby>けるが<ruby>勝<rt>か</rt></ruby>ち」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>一<rt>ひと</rt></ruby><ruby>時<rt>とき</rt></ruby>の<ruby>敗<rt>はい</rt></ruby><ruby>北<rt>ぼく</rt></ruby>や<ruby>譲<rt>じょう</rt></ruby><ruby>歩<rt>ほ</rt></ruby>が、<ruby>長<rt>なが</rt></ruby>い<ruby>目<rt>め</rt></ruby>で<ruby>見<rt>み</rt></ruby>ると<ruby>勝<rt>しょう</rt></ruby><ruby>利<rt>り</rt></ruby>につながること。", distractors: ["<ruby>勝<rt>しょう</rt></ruby><ruby>負<rt>ぶ</rt></ruby>は<ruby>負<rt>ま</rt></ruby>けても<ruby>勝<rt>か</rt></ruby>ちなのだ。", "<ruby>負<rt>ま</rt></ruby>けても<ruby>悔<rt>くや</rt></ruby>しがる<ruby>必<rt>ひつ</rt></ruby><ruby>要<rt>よう</rt></ruby>はない。"], commentary: "<ruby>目<rt>め</rt></ruby><ruby>先<rt>さき</rt></ruby>の<ruby>争<rt>あらそ</rt></ruby>いに<ruby>勝<rt>か</rt></ruby>つことよりも、<ruby>長<rt>ちょう</rt></ruby><ruby>期<rt>き</rt></ruby><ruby>的<rt>てき</rt></ruby>な<ruby>利<rt>り</rt></ruby><ruby>益<rt>えき</rt></ruby>を<ruby>優<rt>ゆう</rt></ruby><ruby>先<rt>せん</rt></ruby>して<ruby>譲<rt>じょう</rt></ruby><ruby>歩<rt>ほ</rt></ruby>することが<ruby>結<rt>けっ</rt></ruby><ruby>果<rt>か</rt></ruby><ruby>的<rt>てき</rt></ruby>に<ruby>有<rt>ゆう</rt></ruby><ruby>利<rt>り</rt></ruby>になる、という<ruby>意味<rt>いみ</rt></ruby>です。" },
            { q: "「<ruby>雨<rt>あめ</rt></ruby>降<rt>ふ</rt></ruby>って<ruby>地<rt>じ</rt></ruby>固<rt>かた</rt></ruby>まる」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>揉<rt>も</rt></ruby>め<ruby>事<rt>ごと</rt></ruby>など<ruby>悪<rt>わる</rt></ruby>い<ruby>出<rt>で</rt></ruby><ruby>来<rt>き</rt></ruby><ruby>事<rt>ごと</rt></ruby>の<ruby>後<rt>あと</rt></ruby>は、かえって<ruby>前<rt>まえ</rt></ruby>より<ruby>良<rt>よ</rt></ruby>い<ruby>状<rt>じょう</rt></ruby><ruby>態<rt>たい</rt></ruby>になる。", distractors: ["<ruby>雨<rt>あめ</rt></ruby>が<ruby>降<rt>ふ</rt></ruby>ると<ruby>地<rt>じ</rt></ruby><ruby>面<rt>めん</rt></ruby>が<ruby>固<rt>かた</rt></ruby>くなる。", "<ruby>雨<rt>あめ</rt></ruby>の<ruby>後<rt>あと</rt></ruby>は<ruby>農<rt>のう</rt></ruby><ruby>作<rt>さく</rt></ruby><ruby>業<rt>ぎょう</rt></ruby>がしやすい。"], commentary: "ひと<ruby>悶<rt>もん</rt></ruby><ruby>着<rt>ちゃく</rt></ruby>あった<ruby>後<rt>あと</rt></ruby>や<ruby>困<rt>こんな</rt></ruby><ruby>難<rt>ん</rt></ruby>を<ruby>乗<rt>の</rt></ruby>り<ruby>越<rt>こ</rt></ruby>えた<ruby>後<rt>あと</rt></ruby>は、かえって<ruby>基<rt>き</rt></ruby><ruby>礎<rt>そ</rt></ruby>がしっかりとして<ruby>安<rt>あん</rt></ruby><ruby>定<rt>てい</rt></ruby>する、という<ruby>意味<rt>いみ</rt></ruby>です。" },
            { q: "「<ruby>鬼<rt>おに</rt></ruby>に<ruby>金<rt>かな</rt></ruby><ruby>棒<rt>ぼう</rt></ruby>」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>強<rt>つよ</rt></ruby>いものがさらに<ruby>強<rt>つよ</rt></ruby>い<ruby>力<rt>ちから</rt></ruby>を<ruby>得<rt>え</rt></ruby>ること。", distractors: ["<ruby>鬼<rt>おに</rt></ruby>は<ruby>金<rt>かな</rt></ruby><ruby>棒<rt>ぼう</rt></ruby>がないと<ruby>戦<rt>たたか</rt></ruby>えない。", "<ruby>金<rt>かな</rt></ruby><ruby>棒<rt>ぼう</rt></ruby>は<ruby>鬼<rt>おに</rt></ruby>にとってとても<ruby>重<rt>じゅう</rt></ruby><ruby>要<rt>よう</rt></ruby>だ。"], commentary: "ただでさえ<ruby>強<rt>つよ</rt></ruby>い<ruby>鬼<rt>おに</rt></ruby>が、さらに<ruby>強<rt>きょう</rt></ruby><ruby>力<rt>りょく</rt></ruby>な<ruby>武<rt>ぶ</rt></ruby><ruby>器<rt>き</rt></ruby>である<ruby>金<rt>かな</rt></ruby><ruby>棒<rt>ぼう</rt></ruby>を<ruby>持<rt>も</rt></ruby>つことで<ruby>向<rt>む</rt></ruby>かうところ<ruby>敵<rt>てき</rt></ruby>なしになる、という<ruby>例<rt>たと</rt></ruby>えです。" },
            { q: "「<ruby>郷<rt>ごう</rt></ruby>に<ruby>入<rt>い</rt></ruby>っては<ruby>郷<rt>ごう</rt></ruby>に<ruby>従<rt>したが</rt></ruby>え」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>住<rt>す</rt></ruby>む<ruby>場<rt>ば</rt></ruby><ruby>所<rt>しょ</rt></ruby>が<ruby>変<rt>か</rt></ruby>われば、その<ruby>土<rt>と</rt></ruby><ruby>地<rt>ち</rt></ruby>の<ruby>習<rt>しゅう</rt></ruby><ruby>慣<rt>かん</rt></ruby>や<ruby>風<rt>ふう</rt></ruby><ruby>俗<rt>ぞく</rt></ruby>に<ruby>従<rt>したが</rt></ruby>うべきだ。", distractors: ["<ruby>郷<rt>ごう</rt></ruby>に<ruby>入<rt>い</rt></ruby>っても<ruby>自<rt>じ</rt></ruby><ruby>分<rt>ぶん</rt></ruby>の<ruby>流<rt>りゅう</rt></ruby><ruby>儀<rt>ぎ</rt></ruby>を<ruby>貫<rt>つらぬ</rt></ruby>くべきだ。", "<ruby>郷<rt>ごう</rt></ruby>に<ruby>入<rt>い</rt></ruby>ったら<ruby>村<rt>むら</rt></ruby><ruby>人<rt>びと</rt></ruby><ruby>全<rt>ぜん</rt></ruby><ruby>員<rt>いん</rt></ruby>に<ruby>従<rt>したが</rt></ruby>わなければならない。"], commentary: "<ruby>新<rt>あたら</rt></ruby>しい<ruby>環<rt>かん</rt></ruby><ruby>境<rt>きょう</rt></ruby>では、そこのルールや<ruby>慣<rt>かん</rt></ruby><ruby>習<rt>しゅう</rt></ruby>を<ruby>尊<rt>そん</rt></ruby><ruby>重<rt>ちょう</rt></ruby>しなさい、という<ruby>教<rt>きょう</rt></ruby><ruby>訓<rt>くん</rt></ruby>です。" },
            { q: "「<ruby>備<rt>そな</rt></ruby>えあれば<ruby>憂<rt>うれ</rt></ruby>いなし」の<ruby>正<rt>ただ</rt></ruby>しい<ruby>意味<rt>いみ</rt></ruby>は？", correct: "<ruby>普<rt>ふ</rt></ruby><ruby>段<rt>だん</rt></ruby>から<ruby>準<rt>じゅん</rt></ruby><ruby>備<rt>び</rt></ruby>しておけば、いざという<ruby>時<rt>とき</rt></ruby>も<ruby>心<rt>しん</rt></ruby><ruby>配<rt>ぱい</rt></ruby>ない。", distractors: ["<ruby>備<rt>そな</rt></ruby>えをしてもしなくても<ruby>憂<rt>うれ</rt></ruby>いは<ruby>尽<rt>つ</rt></ruby>きない。", "<ruby>備<rt>そな</rt></ruby>えをすることは<ruby>人<rt>じん</rt></ruby><ruby>生<rt>せい</rt></ruby>の<ruby>憂<rt>うれ</rt></ruby>いである。"], commentary: "<ruby>日<rt>ひ</rt></ruby><ruby>頃<rt>ごろ</rt></ruby>から<ruby>用<rt>よう</rt></ruby><ruby>意<rt>い</rt></ruby>や<ruby>心<rt>こころ</rt></ruby><ruby>構<rt>がま</rt></ruby>えをしておけば、<ruby>突<rt>とっ</rt></ruby><ruby>発<rt>はつ</rt></ruby><ruby>的<rt>てき</rt></ruby>な<ruby>事<rt>じ</rt></ruby><ruby>態<rt>たい</rt></ruby>が<ruby>起<rt>お</rt></ruby>きても<ruby>心<rt>しん</rt></ruby><ruby>配<rt>ぱい</rt></ruby>ごとがない、という<ruby>意味<rt>いみ</rt></ruby>です。" },
        ];

        // 10種類の材料の情報 (初期状態とグレードアップ後)
        const materials = [
            // { score: 1 }
            { id: 'mat-katsu', initial: { icon: '🐷', text: '豚肉' }, upgraded: { icon: '👑', text: '特選ロース' } },
            // { score: 2 }
            { id: 'mat-egg', initial: { icon: '🥚', text: '卵' }, upgraded: { icon: '🌟', text: '黄金とろ卵' } },
            // { score: 3 }
            { id: 'mat-rice', initial: { icon: '🍚', text: 'ご飯' }, upgraded: { icon: '🌾', text: '特選コシヒカリ' } },
            // { score: 4 }
            { id: 'mat-onion', initial: { icon: '🧅', text: '玉ねぎ' }, upgraded: { icon: '💎', text: '淡路産玉ねぎ' } },
            // { score: 5 }
            { id: 'mat-mitsuba', initial: { icon: '🌿', text: '三つ葉' }, upgraded: { icon: '🍃', text: '香り三つ葉' } },
            // { score: 6 }
            { id: 'mat-panko', initial: { icon: '🍞', text: 'パン粉' }, upgraded: { icon: '✨', text: '極上生パン粉' } },
            // { score: 7 }
            { id: 'mat-oil', initial: { icon: '🏺', text: '油' }, upgraded: { icon: '☀️', text: '最高級米油' } },
            // { score: 8 }
            { id: 'mat-soy', initial: { icon: '🥢', text: '醤油' }, upgraded: { icon: '🔥', text: '熟成醤油' } },
            // { score: 9 }
            { id: 'mat-sugar', initial: { icon: '🍬', text: '砂糖' }, upgraded: { icon: '🍯', text: '本みりん' } },
            // { score: 10 }
            { id: 'mat-bowl', initial: { icon: '🥣', text: '器' }, upgraded: { icon: '🍶', text: '高級漆器' } },
        ];

        let quizData = []; // 実際に使う10問を格納する配列
        const TOTAL_QUESTIONS = 10; // 出題数

        // グローバルなゲーム状態
        let currentQuestionIndex = 0;
        let score = 0;
        let currentCorrectAnswer = 0; // 現在の問題の正解ボタン番号 (1, 2, 3)

        // ユーティリティ: 配列をシャッフルする (Fisher-Yates)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        /**
         * クイズを初期設定し、最初の問題を表示します。
         */
        function setupQuiz() {
            // 1. 全問題からランダムに10問を選択する
            const shuffledAllQuiz = shuffleArray([...allQuizData]); 
            quizData = shuffledAllQuiz.slice(0, TOTAL_QUESTIONS);

            currentQuestionIndex = 0;
            score = 0;
            
            // UIの表示状態をリセット
            document.getElementById('quiz-area').classList.remove('hidden');
            document.getElementById('final-result-area').classList.add('hidden');
            document.getElementById('explanation-area').classList.add('hidden'); // 解説エリアを非表示に
            document.getElementById('next-button').textContent = '次の問題へ';
            document.getElementById('next-button').disabled = true;
            document.getElementById('katsudon-image-container').innerHTML = `<span id="initial-message">結果を待っています...</span>`;

            // 材料スロットのリセット
            materials.forEach(mat => {
                const slot = document.getElementById(mat.id);
                slot.className = 'material-slot text-center text-gray-400 transition duration-300';
                // 初期アイコンとテキストを設定
                slot.querySelector('span').textContent = mat.initial.icon;
                slot.querySelector('p').textContent = mat.initial.text;
            });

            loadQuestion();
        }

        /**
         * 次の問題をロードし、選択肢をランダムに配置します。
         */
        function loadQuestion() {
            // ゲーム終了判定
            if (currentQuestionIndex >= quizData.length) {
                showResult();
                return;
            }

            const data = quizData[currentQuestionIndex];
            
            // 1. 問題文を更新 (ルビ表示のためinnerHTMLを使用)
            document.getElementById('question-text').innerHTML = data.q;
            
            // 2. 選択肢テキストを準備し、シャッフル
            let options = [data.correct, ...data.distractors];
            options = shuffleArray(options); 

            // 3. ボタンにシャッフルされた選択肢を設定し、正解ボタン番号を記録
            document.querySelectorAll('.answer-btn').forEach((button, index) => {
                const buttonNumber = index + 1;
                const optionText = options[index];

                // 選択肢の表記をテキストのみに修正 (ルビ表示のためinnerHTMLを使用)
                button.innerHTML = optionText;
                
                if (optionText === data.correct) {
                    currentCorrectAnswer = buttonNumber;
                }
                
                // 4. ボタンのスタイルと状態をリセット
                button.className = 'answer-btn w-full text-left py-3 px-5 bg-white text-gray-800 border-2 border-yellow-300 rounded-lg hover:bg-yellow-100 transition duration-150 font-medium shadow-md';
                button.disabled = false;
            });
            
            // 5. ステータスを更新
            document.getElementById('score-display').textContent = `スコア: ${score} / ${quizData.length}`;
            document.getElementById('progress-display').textContent = `問題 ${currentQuestionIndex + 1} / ${quizData.length}`;

            // 6. 結果メッセージと解説を非表示にし、次のボタンを無効化
            document.getElementById('result-message').classList.add('hidden');
            document.getElementById('explanation-area').classList.add('hidden');
            document.getElementById('next-button').disabled = true;

            console.log(`--- 問題 ${currentQuestionIndex + 1} セットアップ完了 ---`);
        }

        /**
         * ユーザーの選択が正解かどうかをチェックし、スコアを更新します。
         * @param {number} selectedAnswer - ユーザーが選択した答えの番号 (1, 2, または 3)
         */
        function checkAnswer(selectedAnswer) {
            // すでに回答済みでないかチェック
            if (document.getElementById('next-button').disabled === false) return;
            
            const resultMessage = document.getElementById('result-message');
            const explanationArea = document.getElementById('explanation-area');
            const data = quizData[currentQuestionIndex];
            let isCorrect = (selectedAnswer === currentCorrectAnswer);

            // スコアを更新
            if (isCorrect) {
                score++;
                resultMessage.textContent = '大正解！最高級の材料ゲットです！';
                resultMessage.className = 'text-center p-4 rounded-lg mb-4 text-green-700 bg-green-100 font-bold';
                
                // 材料スロットのアップグレードをチェック
                updateMaterialGrade();

            } else {
                resultMessage.textContent = `不正解... 材料のアップグレードに失敗しました。（正解は ${currentCorrectAnswer} の選択肢でした）`;
                resultMessage.className = 'text-center p-4 rounded-lg mb-4 text-red-700 bg-red-100 font-bold';
            }
            
            // 解説を表示 (ルビ表示のためinnerHTMLを使用)
            document.getElementById('explanation-text').innerHTML = data.commentary;
            explanationArea.classList.remove('hidden');
            resultMessage.classList.remove('hidden');

            // 全てのボタンを無効化し、スタイルを反映
            document.querySelectorAll('.answer-btn').forEach(button => {
                button.disabled = true;
                const answerNumber = parseInt(button.getAttribute('data-answer'));
                
                if (answerNumber === currentCorrectAnswer) {
                    button.classList.add('bg-green-200', 'border-green-500', 'shadow-inner');
                    button.classList.remove('hover:bg-yellow-100', 'border-yellow-300', 'shadow-md');
                } else if (answerNumber === selectedAnswer && !isCorrect) {
                    button.classList.add('bg-red-200', 'border-red-500', 'shadow-inner');
                    button.classList.remove('hover:bg-yellow-100', 'border-yellow-300', 'shadow-md');
                }
            });

            // 次のボタンを有効化
            document.getElementById('next-button').disabled = false;

            // 最終問題ならボタンのテキストを変更
            if (currentQuestionIndex === quizData.length - 1) {
                document.getElementById('next-button').textContent = '結果を見る';
            }
        }

        /**
         * 現在のスコアに基づき、材料アイコンのグレードを更新します。
         */
        function updateMaterialGrade() {
            // スコア1から10まで、1点ごとにmaterials配列の要素を順にアップグレード
            const materialToUpdate = materials[score - 1]; 

            if (materialToUpdate) {
                const slot = document.getElementById(materialToUpdate.id);
                // クラスのリセットと新しいクラスを追加
                slot.className = 'material-slot text-center transition duration-300';
                slot.classList.add('material-upgraded', 'font-extrabold');
                
                // スロット内のspanとpタグを更新
                const span = slot.querySelector('span');
                const p = slot.querySelector('p');

                // spanタグの内容を更新
                span.textContent = materialToUpdate.upgraded.icon;
                
                // pタグの内容を更新
                p.textContent = materialToUpdate.upgraded.text;
            }
        }

        /**
         * 画像生成AIを呼び出し、Base64画像をコンテナに挿入します。
         */
        async function generateKatsudonImage(prompt, containerElement) {
            const apiKey = ""; // APIキーはシステムにより提供されます
            // 画像生成モデルのAPIエンドポイント
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predict?key=${apiKey}`;

            const payload = {
                instances: [{ prompt: prompt }],
                parameters: { "sampleCount": 1 }
            };

            const MAX_RETRIES = 5;
            for (let i = 0; i < MAX_RETRIES; i++) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const result = await response.json();

                    if (result.predictions && result.predictions.length > 0 && result.predictions[0].bytesBase64Encoded) {
                        const base64Data = result.predictions[0].bytesBase64Encoded;
                        const imageUrl = `data:image/png;base64,${base64Data}`;

                        // 成功したら<img>タグを挿入
                        containerElement.innerHTML = `<img src="${imageUrl}" class="w-full h-auto rounded-lg shadow-xl object-cover aspect-video" alt="完成したカツ丼の画像">`;
                        return; // 成功
                    } else {
                        throw new Error("画像データがレスポンスに含まれていません。");
                    }
                } catch (error) {
                    console.error(`画像生成失敗 (リトライ ${i + 1}/${MAX_RETRIES}):`, error);
                    if (i < MAX_RETRIES - 1) {
                        // 指数関数的バックオフ
                        const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                        await new Promise(resolve => setTimeout(resolve, delay));
                    } else {
                        // 最終的に失敗した場合
                        containerElement.innerHTML = `<div class="p-8 text-red-600">画像を生成できませんでした。ネットワーク接続を確認してください。</div>`;
                    }
                }
            }
        }
        
        /**
         * 最終スコアに基づいて完成したカツ丼を表示します。
         */
        async function showResult() { 
            // UIを切り替え
            document.getElementById('quiz-area').classList.add('hidden');
            document.getElementById('final-result-area').classList.remove('hidden');
            
            const finalMessage = document.getElementById('final-message');
            const gradeExplanation = document.getElementById('grade-explanation');
            const katsudonImageContainer = document.getElementById('katsudon-image-container');

            let title, description, prompt; 

            // ローディング表示
            katsudonImageContainer.innerHTML = `<div class="p-8"><div class="animate-spin rounded-full h-10 w-10 border-b-2 border-yellow-600 mx-auto mb-2"></div><span id="loading-text">AIがカツ丼を調理中...少々お待ちください！</span></div>`;

            if (score === TOTAL_QUESTIONS) {
                // 満点 (10/10)
                title = `神業達成！至高の豪華カツ丼！`;
                description = `**おめでとうございます！** 全問<ruby>正<rt>せい</rt></ruby><ruby>解<rt>かい</rt></ruby>で10<ruby>種類<rt>しゅるい</rt></ruby>の<ruby>材料<rt>ざいりょう</rt></ruby>すべてが<ruby>最高<rt>さいこう</rt></ruby><ruby>級<rt>きゅう</rt></ruby><ruby>品<rt>ひん</rt></ruby>にアップグレードされました。この<ruby>世<rt>よ</rt></ruby>の<ruby>贅<rt>ぜい</rt></ruby>を<ruby>尽<rt>つ</rt></ruby>くした<ruby>究<rt>きゅう</rt></ruby><ruby>極<rt>きょく</rt></ruby>の<ruby>一<rt>いっ</rt></ruby><ruby>杯<rt>ぱい</rt></ruby>が、あなたの<ruby>努<rt>ど</rt></ruby><ruby>力<rt>りょく</rt></ruby>の<ruby>結<rt>けっ</rt></ruby><ruby>晶<rt>しょう</rt></ruby>です。<ruby>最高<rt>さいこう</rt></ruby>の<ruby>味<rt>あじ</rt></ruby>を<ruby>堪<rt>たん</rt></ruby><ruby>能<rt>のう</rt></ruby>してください！`;
                prompt = "A hyper-realistic, mouth-watering, extremely luxurious katsudon, thick golden fried pork cutlet, perfectly cooked, runny golden egg, shiny green mitsuba, glistening sauce, on a beautiful lacquer bowl, exquisite Japanese cuisine, soft studio lighting, professional food photography, high resolution, detailed, cinematic. Japanese style, on a wooden table, in a traditional Japanese setting.";
                finalMessage.className = 'text-2xl font-extrabold mb-4 text-yellow-600';
                
            } else if (score >= 7) {
                // 上 (7-9/10)
                title = `素晴らしい！特選カツ丼が完成！ (${score}/${TOTAL_QUESTIONS} 正解)`;
                description = `**<ruby>見事<rt>みごと</rt></ruby>な<ruby>成績<rt>せいせき</rt></ruby>です！** <ruby>主要<rt>しゅよう</rt></ruby>な<ruby>材料<rt>ざいりょう</rt></ruby>のほとんどが<ruby>豪華<rt>ごうか</rt></ruby>な<ruby>品<rt>ひん</rt></ruby>にグレードアップしました。<ruby>惜<rt>お</rt></ruby>しくも<ruby>満<rt>まん</rt></ruby><ruby>点<rt>てん</rt></ruby>には<ruby>届<rt>とど</rt></ruby>きませんでしたが、<ruby>文句<rt>もんく</rt></ruby>なしに<ruby>美<rt>おい</rt></ruby>しいプレミアムなカツ<ruby>丼<rt>どん</rt></ruby>です。`;
                prompt = "A delicious looking katsudon, golden brown fried pork cutlet, soft egg, green garnish, steaming rice, a standard but very appetizing Japanese dish, warm lighting, food photography, served in a ceramic bowl.";
                finalMessage.className = 'text-2xl font-extrabold mb-4 text-gray-700';

            } else if (score >= 4) {
                // 並 (4-6/10)
                title = `よくできました！並カツ丼が完成。 (${score}/${TOTAL_QUESTIONS} 正解)`;
                description = `**<ruby>頑<rt>がん</rt></ruby><ruby>張<rt>ば</rt></ruby>りましたね！** <ruby>半<rt>はん</rt></ruby><ruby>分<rt>ぶん</rt></ruby><ruby>程<rt>てい</rt></ruby><ruby>度<rt>ど</rt></ruby>の<ruby>材料<rt>ざいりょう</rt></ruby>がグレードアップし、<ruby>標準<rt>ひょうじゅん</rt></ruby><ruby>以上<rt>いじょう</rt></ruby>の<ruby>美<rt>おい</rt></ruby>しいカツ<ruby>丼<rt>どん</rt></ruby>が<ruby>完成<rt>かんせい</rt></ruby>しました。<ruby>豪華<rt>ごうか</rt></ruby>カツ<ruby>丼<rt>どん</rt></ruby>には<ruby>届<rt>とど</rt></ruby>きませんでしたが、この<ruby>一<rt>いっ</rt></ruby><ruby>歩<rt>ぽ</rt></ruby>が<ruby>次<rt>つぎ</rt></ruby>につながります！`;
                prompt = "A simple katsudon, decent fried pork cutlet, egg, rice, a basic Japanese meal, home cooking style, natural lighting, served in a plain bowl, viewed from above.";
                finalMessage.className = 'text-2xl font-extrabold mb-4 text-red-600';
            } else {
                // 残念 (0-3/10)
                title = `次こそ<ruby>頑<rt>がん</rt></ruby><ruby>張<rt>ば</rt></ruby>ろう！<ruby>惜<rt>お</rt></ruby>しいカツ<ruby>丼<rt>どん</rt></ruby> (${score}/${TOTAL_QUESTIONS} 正解)`;
                description = `**<ruby>諦<rt>あきら</rt></ruby>めないでください！** <ruby>材料<rt>ざいりょう</rt></ruby>のアップグレードがほとんど<ruby>進<rt>すす</rt></ruby>みませんでした。<ruby>次<rt>つぎ</rt></ruby>は<ruby>一<rt>ひと</rt></ruby>つでも<ruby>多<rt>おお</rt></ruby>く<ruby>正<rt>せい</rt></ruby><ruby>解<rt>かい</rt></ruby>して、より<ruby>良<rt>よ</rt></ruby>い<ruby>材料<rt>ざいりょう</rt></ruby>を<ruby>手<rt>て</rt></ruby>に<ruby>入<rt>い</rt></ruby>れましょう。<ruby>再<rt>さい</rt></ruby><ruby>挑<rt>ちょう</rt></ruby><ruby>戦<rt>せん</rt></ruby>を<ruby>応<rt>おう</rt></ruby><ruby>援<rt>えん</rt></ruby>しています！`;
                prompt = "A very plain bowl of rice with minimal, thin toppings, maybe a small piece of cutlet and some egg, looks a bit sad and sparse, representing a lack of ingredients, dim lighting, high contrast, low quality presentation, side view.";
                finalMessage.className = 'text-2xl font-extrabold mb-4 text-red-800';
            }

            finalMessage.innerHTML = title;
            gradeExplanation.innerHTML = description;

            // 画像生成関数を呼び出し、結果を待つ
            await generateKatsudonImage(prompt, katsudonImageContainer);
        }


        // 初期ロード時に関数実行とイベントリスナーの設定
        window.onload = function() {
            setupQuiz(); 

            // 各回答ボタンにイベントリスナーを設定
            document.querySelectorAll('.answer-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const selected = parseInt(this.getAttribute('data-answer'));
                    checkAnswer(selected);
                });
            });
            
            // 次へ/結果表示ボタンにイベントリスナーを設定
            document.getElementById('next-button').addEventListener('click', function() {
                currentQuestionIndex++;
                if (currentQuestionIndex < quizData.length) {
                    loadQuestion();
                } else {
                    showResult();
                }
            });
        };
    </script>
</body>
</html>
